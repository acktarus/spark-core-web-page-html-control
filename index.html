<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<title>AJAX Post Spark Core form demo</title>








<script type="text/javascript">


///////////////////////////////// Start boring AJAX stuff that you don't need to know ///////////////////////////////////////




var loadingmessage = 'Processing...';
function setAjax(){
   var xmlHttp;
   try{
      xmlHttp=new XMLHttpRequest(); // Firefox, Opera 8.0+, Safari
      return xmlHttp;
   }
   catch (e){
      try{
         xmlHttp=new ActiveXObject("Msxml2.XMLHTTP"); // Internet Explorer
         return xmlHttp;
      }
      catch (e){
         try{
            xmlHttp=new ActiveXObject("Microsoft.XMLHTTP");
            return xmlHttp;
         }
         catch (e){
            alert("Your browser does not support AJAX!");
            return false;
         }
     }
   }
}
function myAjax(f, url, myDivToChange) {
   var poststr = getFormValues(f);
    postData(url, poststr, myDivToChange);
}
function postData(url, parameters, myDivToChange2){
   var xmlHttp = setAjax();
   xmlHttp.onreadystatechange =  function(){
      if(xmlHttp.readyState > 0 && xmlHttp.readyState < 4){
          document.getElementById(myDivToChange2).innerHTML=loadingmessage;
      }
      if (xmlHttp.readyState == 4) {

             
///////////////////////////////// Start area you might be interested in ///////////////////////////////////////
             
             

             
         document.getElementById(myDivToChange2).innerHTML=xmlHttp.responseText+' data sent was '+parameters;
         
         
        
    
///////////////////////////////// End area you might be interested in ///////////////////////////////////////     
         

         
      }
   }
   xmlHttp.open("POST", url, true);
   xmlHttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
   xmlHttp.send(parameters);
}
function getFormValues(fobj){
   var str = "";
   var valueArr = null;
   var val = "";
   var cmd = "";
   for(var i = 0;i < fobj.elements.length;i++){
      switch(fobj.elements[i].type){
         case "text":
            str += fobj.elements[i].name +"=" + escape(fobj.elements[i].value) + "&";
            break;
         case "textarea":
            str += fobj.elements[i].name +"=" + escape(fobj.elements[i].value) + "&";
            break;
         case "select-one":
             str += fobj.elements[i].name +"=" + fobj.elements[i].options[fobj.elements[i].selectedIndex].value + "&";
             break;
     }
   }
   str = str.substr(0,(str.length - 1));
   return str;
}





///////////////////////////////// End boring AJAX stuff that you don't need to know ///////////////////////////////////////

</script>














</head>

<body onload="document.all.myForm.myName.select()">




Type in the boxes then click submit to activate AJAX.<br>
<form name="myForm" method="POST" action = "https://api.spark.io/v1/devices/sparkCoreName/myTurnOn" >

Access Token: <input id="myToken" name="access_token" type=text size=50 placeholder="76sdf78sd9f7sd6f87s6dfgsf76g"> 
Get this from the settings area when logged into <a href="http://spark.io">http://spark.io</a><br>

Device ID: <input id="myDeviceId" name="myCoreID" type=text size=50 placeholder="3453534534345"> 
Get this from the core area when logged in<br>


Function Name:<input id="myFunctionName" name="myFunction"  type=text size=50 placeholder="myTurnOn" > Get this from the program you flashed to your spark core<br>

Parameter if needed: <input id="myParameter" name="params" type=text size=50 placeholder="D7 HIGH"> Optional your function my not need it<br>


<input type=button value=submit onClick="{
   document.myForm.action = 'https://api.spark.io/v1/devices/' + document.all.myDeviceId.value + '/' + document.all.myFunctionName.value
   document.all.myPostingData.value = document.myForm.action + '?access_token=' + document.all.myToken.value
   if (document.all.myParameter.value != ''){
      document.all.myPostingData.value += '&params=' + document.all.myParameter.value
   }
    
   myAjax(this.form, document.myForm.action, 'myDiv1')    

}">

</form>

This textarea is outside of the form that is sent to AJAX. It is a command that could be sent as a URL in your browser<br>
<textarea id="myPostingData" rows=6 cols=70 >
   
   
   
</textarea>



<div id="myDiv1" style="color: blue;"></div>












<br>At the bottom of every page make sure you include the following button:<br>

<input type=button value="Back" style="font-size:25px" onclick="{window.history.back()}"><br><br>






</body>
</html>
